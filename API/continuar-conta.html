<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDon4WbCbe4kCkUq-OdLBRhzhMaUObbAfo",
    authDomain: "html-15e80.firebaseapp.com",
    databaseURL: "https://html-15e80-default-rtdb.firebaseio.com",
    projectId: "html-15e80",
    storageBucket: "html-15e80.appspot.com",
    messagingSenderId: "1068148640439",
    appId: "1:1068148640439:web:7cc5bde34f4c5a5ce41b32"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  const urlParams = new URLSearchParams(window.location.search);
  const appToken = urlParams.get('token');

  if (!appToken) {
    console.error('Token is missing!');
    window.location.href = "auth.html";
  }

  onAuthStateChanged(auth, (user) => {
    if (!user) {
      // Redirect to auth.html with token when user isn't logged in
      window.location.href = `auth.html?token=${appToken}`;
    } else {
      // Ensure the token redirects back to continuar-conta.html
      window.location.href = `continuar-conta.html?token=${appToken}`;
    }
  });
</script>
