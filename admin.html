<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel Admin</title>
<style>
body{background:#111;color:#fff;font-family:Arial;padding:20px}
.user{border:1px solid #444;padding:10px;margin:10px}
.online{color:lime}
.offline{color:red}
button{margin:4px;cursor:pointer}
pre{background:#000;padding:10px;overflow:auto}
</style>
</head>
<body>

<h1>Painel Administrador</h1>
<div id="users">Carregando...</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getDatabase, ref, onValue, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDon4WbCbe4kCkUq-OdLBRhzhMaUObbAfo",
  authDomain: "html-15e80.firebaseapp.com",
  databaseURL: "https://html-15e80-default-rtdb.firebaseio.com",
  projectId: "html-15e80",
  storageBucket: "html-15e80.firebasestorage.app",
  appId: "1:1068148640439:web:7cc5bde34f4c5a5ce41b32"
};

const ADMIN_EMAIL = "administrador1@codehub.ct.ws";
const ADMIN_PASSWORD = "SUA_SENHA_AQUI"; // coloque a senha do admin

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);
const usersDiv = document.getElementById("users");

// login automÃ¡tico
signInWithEmailAndPassword(auth, ADMIN_EMAIL, ADMIN_PASSWORD)
.catch(err => {
  usersDiv.innerHTML = "<h2>Falha no login do administrador</h2>";
});

onAuthStateChanged(auth, user => {
  if (!user || user.email !== ADMIN_EMAIL) {
    usersDiv.innerHTML = "<h2>Acesso negado</h2>";
    return;
  }

  // painel funcionando
  onValue(ref(db,"users"), snap => {
    const users = snap.val() || {};
    usersDiv.innerHTML = "";

    Object.entries(users).forEach(([uid,u])=>{
      const div = document.createElement("div");
      div.className = "user";
      div.innerHTML = `
        <b>${u.email || uid}</b><br>
        ${u.online?"ðŸŸ¢ Online":"ðŸ”´ Offline"}<br>
        Banido: ${u.ban?.active?"SIM":"NÃƒO"}<br>
        <button onclick="ban('${uid}',1)">Ban 1 dia</button>
        <button onclick="ban('${uid}',7)">Ban 7 dias</button>
        <button onclick="unban('${uid}')">Desbanir</button>
        <details>
          <summary>Storage</summary>
          <pre>${JSON.stringify(u.storage,null,2)}</pre>
        </details>
      `;
      usersDiv.appendChild(div);
    });
  });
});

window.ban = (uid,days)=>{
  update(ref(db,"users/"+uid+"/ban"),{
    active:true,
    until: Date.now()+days*24*60*60*1000
  });
};

window.unban = uid=>{
  update(ref(db,"users/"+uid+"/ban"),{
    active:false,
    until:null
  });
};
</script>

</body>
</html>